# 오늘 데이터 수집 문제점 분석 및 해결 계획

## 📊 문제 현황

### 전체 통계
- **오늘 수집된 뉴스**: 1,039개
- **내용 없음 (<10자)**: 667개 (64.2%) ⚠️
- **내용 부족 (10~49자)**: 183개 (17.6%)
- **내용 양호 (≥50자)**: 189개 (18.2%)

### 출처별 실패율
1. **naver_finance**: 70.0% 실패율 (431개/616개) ❌
2. **hankyung**: 62.3% 실패율 (236개/379개) ❌
3. **mk_news**: 0% 실패율 (44개 모두 성공) ✅

## 🔍 문제 원인 분석

### 주요 원인
1. **상세 페이지 크롤링 실패**
   - `crawl_news_detail()` 메서드가 None 반환 또는 빈 내용 반환
   - CSS 선택자가 웹사이트 구조 변경에 맞지 않음
   - JavaScript로 동적 로딩되는 콘텐츠 미처리

2. **네이버 금융 특정 문제**
   - URL 패턴: `/news/news_read.naver?article_id=...`
   - 본문 추출 선택자가 작동하지 않음
   - 431개 중 183개는 요약만 있고 본문 없음

3. **한국경제 특정 문제**
   - 236개 뉴스의 상세 페이지 크롤링 실패
   - 본문 추출 선택자 패턴 불일치

## 🛠️ 해결 계획

### Phase 1: 즉시 개선 (단기)

#### 1.1 네이버 금융 크롤러 개선
**목표**: 실패율 70% → 30% 이하

**작업 내용**:
- [ ] 네이버 금융 본문 선택자 추가/수정
  - 현재 선택자 패턴 검증
  - 실제 HTML 구조 분석
  - 더 많은 선택자 패턴 추가
- [ ] 요약 정보 활용 강화
  - 상세 페이지 실패 시 목록 페이지 요약이라도 저장
  - 요약이 10자 이상이면 최소한의 내용으로 저장
- [ ] 에러 핸들링 개선
  - 크롤링 실패 시 상세 로그 기록
  - 실패한 URL 패턴 분석

**예상 소요 시간**: 2-3시간

#### 1.2 한국경제 크롤러 개선
**목표**: 실패율 62.3% → 20% 이하

**작업 내용**:
- [ ] 한국경제 본문 선택자 추가/수정
  - 실제 HTML 구조 재분석
  - 다양한 선택자 패턴 시도
- [ ] 요약 정보 활용 강화
- [ ] 에러 핸들링 개선

**예상 소요 시간**: 1-2시간

#### 1.3 재처리 스크립트 실행
**목표**: 기존 데이터 보완

**작업 내용**:
- [ ] `reprocess_data.py` 실행
  - 내용이 없는 667개 뉴스 재크롤링
  - 실패한 URL 재시도
- [ ] 재처리 결과 모니터링

**예상 소요 시간**: 30분-1시간 (크롤링 시간 포함)

### Phase 2: 근본적 개선 (중기)

#### 2.1 크롤러 로직 개선
**작업 내용**:
- [ ] 다단계 본문 추출 전략
  1. 1차: 특정 선택자 시도
  2. 2차: 일반적인 본문 패턴 시도
  3. 3차: 전체 페이지에서 본문 영역 추정
  4. 4차: 요약 정보라도 저장
- [ ] 재시도 로직 강화
  - 실패 시 다른 선택자로 재시도
  - 지수 백오프 적용
- [ ] JavaScript 동적 콘텐츠 처리
  - Selenium 또는 Playwright 도입 검토
  - 필요한 경우에만 사용 (성능 고려)

**예상 소요 시간**: 4-6시간

#### 2.2 로깅 및 모니터링 강화
**작업 내용**:
- [ ] 상세 크롤링 실패 로그
  - 실패한 URL 기록
  - 실패 원인 분류 (선택자 실패, 네트워크 오류, 기타)
  - 실패 패턴 통계 수집
- [ ] 실시간 모니터링 대시보드
  - 크롤러별 성공/실패율
  - 시간대별 수집 현황
  - 문제 발생 시 알림

**예상 소요 시간**: 2-3시간

#### 2.3 데이터 품질 검증 자동화
**작업 내용**:
- [ ] 수집 후 자동 검증
  - 내용 길이 체크
  - 필수 필드 검증
  - 품질 점수 계산
- [ ] 자동 재처리
  - 품질 점수가 낮은 뉴스 자동 재크롤링
  - 실패한 뉴스 재시도 큐 관리

**예상 소요 시간**: 3-4시간

### Phase 3: 장기 개선 (선택)

#### 3.1 대체 크롤링 방법
**작업 내용**:
- [ ] RSS 피드 활용 (가능한 경우)
- [ ] API 활용 (제공되는 경우)
- [ ] 헤드리스 브라우저 도입 (Selenium/Playwright)

**예상 소요 시간**: 8-12시간

## 📋 우선순위 작업 목록

### 🔴 긴급 (오늘)
1. 네이버 금융 크롤러 본문 선택자 수정
2. 한국경제 크롤러 본문 선택자 수정
3. 요약 정보 활용 로직 추가
4. 재처리 스크립트 실행

### 🟡 중요 (이번 주)
5. 크롤러 로직 개선 (다단계 추출)
6. 로깅 강화
7. 에러 핸들링 개선

### 🟢 개선 (다음 주)
8. 데이터 품질 검증 자동화
9. 모니터링 대시보드
10. JavaScript 동적 콘텐츠 처리 검토

## 📈 기대 효과

### 단기 (Phase 1 완료 후)
- 내용 완성도: 18.2% → 50% 이상
- naver_finance 실패율: 70% → 30% 이하
- hankyung 실패율: 62.3% → 20% 이하

### 중기 (Phase 2 완료 후)
- 내용 완성도: 50% → 80% 이상
- 전체 실패율: 30% → 10% 이하
- 자동 재처리로 품질 유지

## ⚠️ 주의사항

1. **웹사이트 구조 변경 대응**
   - 크롤러는 웹사이트 구조 변경에 취약함
   - 정기적인 모니터링 필요

2. **크롤링 속도 제한**
   - 과도한 요청 시 IP 차단 가능
   - 적절한 딜레이 유지

3. **법적 고려사항**
   - robots.txt 준수
   - 이용약관 확인
   - 적절한 크롤링 주기 유지

## 🎯 다음 단계

1. **네이버 금융 크롤러 분석**
   - 실제 HTML 구조 확인
   - 본문 선택자 패턴 테스트
   - 수정 사항 적용

2. **한국경제 크롤러 분석**
   - 실제 HTML 구조 확인
   - 본문 선택자 패턴 테스트
   - 수정 사항 적용

3. **테스트 및 검증**
   - 수정된 크롤러로 샘플 크롤링
   - 성공률 확인
   - 문제점 추가 수정

